"use strict";var _index = require("../config/index");
var _mongoose = _interopRequireDefault(require("mongoose"));function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { "default": obj };}

var connectionOptions = {
  useNewUrlParser: true,
  user: _index.mongo_user,
  pass: _index.mongo_password };


_mongoose["default"].plugin(require('mongoose-lean-virtuals'));
_mongoose["default"].set('useCreateIndex', true);
_mongoose["default"].connection.
on('connecting', function () {return console.log('> Connecting to Mongo Database ...');}).
on('connected', function () {return console.log('> Connected to Mongo Database!');}).
on('error', function (error) {
  console.log('Connection error with Mongo', error);
  _mongoose["default"].connection.close();
});

/**
     * In case Mongo container is not ready (because of credentials config)
     */
var connectWithRetry = function connectWithRetry() {
  _mongoose["default"].connect("mongodb://".concat(_index.mongo_url, "?authSource=admin"), connectionOptions, function (err) {
    if (err) {
      setTimeout(connectWithRetry, 3000);
    }
  });
};

connectWithRetry();
module.exports = _mongoose["default"];
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tb25nby9pbmRleC5qcyJdLCJuYW1lcyI6WyJjb25uZWN0aW9uT3B0aW9ucyIsInVzZU5ld1VybFBhcnNlciIsInVzZXIiLCJtb25nb191c2VyIiwicGFzcyIsIm1vbmdvX3Bhc3N3b3JkIiwibW9uZ29vc2UiLCJwbHVnaW4iLCJyZXF1aXJlIiwic2V0IiwiY29ubmVjdGlvbiIsIm9uIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwiY2xvc2UiLCJjb25uZWN0V2l0aFJldHJ5IiwiY29ubmVjdCIsIm1vbmdvX3VybCIsImVyciIsInNldFRpbWVvdXQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiYUFBQTtBQUNBLDREOztBQUVBLElBQU1BLGlCQUFpQixHQUFHO0FBQ3RCQyxFQUFBQSxlQUFlLEVBQUUsSUFESztBQUV0QkMsRUFBQUEsSUFBSSxFQUFFQyxpQkFGZ0I7QUFHdEJDLEVBQUFBLElBQUksRUFBRUMscUJBSGdCLEVBQTFCOzs7QUFNQUMscUJBQVNDLE1BQVQsQ0FBZ0JDLE9BQU8sQ0FBQyx3QkFBRCxDQUF2QjtBQUNBRixxQkFBU0csR0FBVCxDQUFhLGdCQUFiLEVBQStCLElBQS9CO0FBQ0FILHFCQUFTSSxVQUFUO0FBQ0tDLEVBREwsQ0FDUSxZQURSLEVBQ3NCLG9CQUFNQyxPQUFPLENBQUNDLEdBQVIsQ0FBWSxvQ0FBWixDQUFOLEVBRHRCO0FBRUtGLEVBRkwsQ0FFUSxXQUZSLEVBRXFCLG9CQUFNQyxPQUFPLENBQUNDLEdBQVIsQ0FBWSxnQ0FBWixDQUFOLEVBRnJCO0FBR0tGLEVBSEwsQ0FHUSxPQUhSLEVBR2lCLFVBQUNHLEtBQUQsRUFBVztBQUNwQkYsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksNkJBQVosRUFBMkNDLEtBQTNDO0FBQ0FSLHVCQUFTSSxVQUFULENBQW9CSyxLQUFwQjtBQUNILENBTkw7O0FBUUE7OztBQUdBLElBQU1DLGdCQUFnQixHQUFHLFNBQW5CQSxnQkFBbUIsR0FBWTtBQUNqQ1YsdUJBQVNXLE9BQVQscUJBQThCQyxnQkFBOUIsd0JBQTREbEIsaUJBQTVELEVBQStFLFVBQUVtQixHQUFGLEVBQVc7QUFDdEYsUUFBSUEsR0FBSixFQUFTO0FBQ0xDLE1BQUFBLFVBQVUsQ0FBQ0osZ0JBQUQsRUFBbUIsSUFBbkIsQ0FBVjtBQUNIO0FBQ0osR0FKRDtBQUtILENBTkQ7O0FBUUFBLGdCQUFnQjtBQUNoQkssTUFBTSxDQUFDQyxPQUFQLEdBQWlCaEIsb0JBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbW9uZ29fdXJsLCBtb25nb19wYXNzd29yZCwgbW9uZ29fdXNlciB9IGZyb20gJy4uL2NvbmZpZy9pbmRleCdcbmltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcblxuY29uc3QgY29ubmVjdGlvbk9wdGlvbnMgPSB7IFxuICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICB1c2VyOiBtb25nb191c2VyLFxuICAgIHBhc3M6IG1vbmdvX3Bhc3N3b3JkXG59O1xuXG5tb25nb29zZS5wbHVnaW4ocmVxdWlyZSgnbW9uZ29vc2UtbGVhbi12aXJ0dWFscycpKVxubW9uZ29vc2Uuc2V0KCd1c2VDcmVhdGVJbmRleCcsIHRydWUpO1xubW9uZ29vc2UuY29ubmVjdGlvblxuICAgIC5vbignY29ubmVjdGluZycsICgpID0+IGNvbnNvbGUubG9nKCc+IENvbm5lY3RpbmcgdG8gTW9uZ28gRGF0YWJhc2UgLi4uJykpXG4gICAgLm9uKCdjb25uZWN0ZWQnLCAoKSA9PiBjb25zb2xlLmxvZygnPiBDb25uZWN0ZWQgdG8gTW9uZ28gRGF0YWJhc2UhJykpXG4gICAgLm9uKCdlcnJvcicsIChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnQ29ubmVjdGlvbiBlcnJvciB3aXRoIE1vbmdvJywgZXJyb3IpO1xuICAgICAgICBtb25nb29zZS5jb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgfSlcblxuLyoqXG4gKiBJbiBjYXNlIE1vbmdvIGNvbnRhaW5lciBpcyBub3QgcmVhZHkgKGJlY2F1c2Ugb2YgY3JlZGVudGlhbHMgY29uZmlnKVxuICovXG5jb25zdCBjb25uZWN0V2l0aFJldHJ5ID0gZnVuY3Rpb24gKCkge1xuICAgIG1vbmdvb3NlLmNvbm5lY3QoYG1vbmdvZGI6Ly8ke21vbmdvX3VybH0/YXV0aFNvdXJjZT1hZG1pbmAsIGNvbm5lY3Rpb25PcHRpb25zLCAoIGVyciApID0+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgc2V0VGltZW91dChjb25uZWN0V2l0aFJldHJ5LCAzMDAwKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuY29ubmVjdFdpdGhSZXRyeSgpO1xubW9kdWxlLmV4cG9ydHMgPSBtb25nb29zZTsiXX0=